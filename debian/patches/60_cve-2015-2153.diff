Description: fix denial of service and possible code execution
Origin: vendor, backport of patch from Debian 4.6.2-4 package

Index: tcpdump-4.5.1/print-rpki-rtr.c
===================================================================
--- tcpdump-4.5.1.orig/print-rpki-rtr.c	2015-04-24 13:00:04.298649590 -0400
+++ tcpdump-4.5.1/print-rpki-rtr.c	2015-04-24 13:00:04.294649613 -0400
@@ -184,6 +184,7 @@
     pdu_header = (rpki_rtr_pdu *)tptr;
     pdu_type = pdu_header->pdu_type;
     pdu_len = EXTRACT_32BITS(pdu_header->length);
+    TCHECK2(tptr, pdu_len);
     hexdump = FALSE;
 
     printf("%sRPKI-RTRv%u, %s PDU (%u), length: %u",
@@ -312,6 +313,11 @@
     if (vflag > 1 || (vflag && hexdump)) {
 	print_unknown_data(tptr,"\n\t  ", pdu_len);
     }
+    return;
+
+ trunc:
+    printf("|trunc");
+    return;
 }
 
 void
